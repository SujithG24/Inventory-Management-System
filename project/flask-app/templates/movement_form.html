{% extends "base.html" %}

{% block title %}{{ action }} Movement - Inventory Management{% endblock %}

{% block content %}
<div class="page-header">
    <h2>{{ action }} Product Movement</h2>
</div>

<div class="card">
    <form method="POST">
        <div class="form-group">
            <label for="product_id">Product *</label>
            <select id="product_id" name="product_id" required>
                <option value="">-- Select Product --</option>
                {% for product in products %}
                <option value="{{ product['product_id'] }}"
                        {% if movement and movement['product_id'] == product['product_id'] %}selected{% endif %}>
                    {{ product['name'] }} ({{ product['product_id'] }})
                </option>
                {% endfor %}
            </select>
        </div>

        <div class="form-group">
            <label for="from_location">From Location</label>
            <select id="from_location" name="from_location">
                <option value="">-- External / Not Applicable --</option>
                {% for location in locations %}
                <option value="{{ location['location_id'] }}"
                        {% if movement and movement['from_location'] == location['location_id'] %}selected{% endif %}>
                    {{ location['name'] }} ({{ location['location_id'] }})
                </option>
                {% endfor %}
            </select>
            <small style="color: #6c757d; display: block; margin-top: 5px;">Leave empty for incoming stock from external sources</small>
        </div>

        <div class="form-group">
            <label for="to_location">To Location</label>
            <select id="to_location" name="to_location">
                <option value="">-- External / Not Applicable --</option>
                {% for location in locations %}
                <option value="{{ location['location_id'] }}"
                        {% if movement and movement['to_location'] == location['location_id'] %}selected{% endif %}>
                    {{ location['name'] }} ({{ location['location_id'] }})
                </option>
                {% endfor %}
            </select>
            <small style="color: #6c757d; display: block; margin-top: 5px;">Leave empty for outgoing stock to external destinations</small>
        </div>

        <div class="form-group">
            <label for="qty">Quantity *</label>
            <input type="number" id="qty" name="qty"
                   value="{{ movement['qty'] if movement else '' }}"
                   min="1" required>
        </div>

        <div style="padding: 15px; background: #fff3cd; border: 2px solid #ffc107; border-radius: 6px; margin-bottom: 20px;">
            <strong style="color: #856404;">Note:</strong>
            <span style="color: #856404;">At least one of "From Location" or "To Location" must be selected.</span>
        </div>

        <div class="form-actions">
            <button type="submit" class="btn btn-primary">{{ action }} Movement</button>
            <a href="{{ url_for('movements') }}" class="btn btn-secondary">Cancel</a>
        </div>
    </form>
</div>
{% endblock %}
